import{p as re,k as N,l as k,u as J,m as Se,n as p,q as Ie,s as Me,t as Pe,v as Ae,x as De,y as Ke,z as _e,A as B,B as ae,C as Ee,D as Re,E as Le,F as U,G as z,H as Oe,I as ne,J as Te,e as ue,a as c,K as X,L as Ne,M as T,N as je,O as ie,P as Be,Q as Ue,R as ze,S as oe,T as He,U as $e,W as Qe,i as We,X as Ge,Y as Je,Z as Xe,$ as Ye,a0 as Ze}from"./app-iozbaKy5.js";const qe=(e,v,a)=>e==null||v==null?-1:e.toString().toLocaleLowerCase().indexOf(v.toString().toLocaleLowerCase()),pe=re({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function el(e,v,a){var b;const u=[],w=(a==null?void 0:a.default)??qe,m=a!=null&&a.filterKeys?p(a.filterKeys):!1,h=Object.keys((a==null?void 0:a.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return u;e:for(let g=0;g<e.length;g++){const[F,A=F]=p(e[g]),S={},r={};let i=-1;if((v||h>0)&&!(a!=null&&a.noFilter)){if(typeof F=="object"){const L=m||Object.keys(A);for(const M of L){const H=Ie(A,M),j=(b=a==null?void 0:a.customKeyFilter)==null?void 0:b[M];if(i=j?j(H,v,F):w(H,v,F),i!==-1&&i!==!1)j?S[M]=i:r[M]=i;else if((a==null?void 0:a.filterMode)==="every")continue e}}else i=w(F,v,F),i!==-1&&i!==!1&&(r.title=i);const I=Object.keys(r).length,_=Object.keys(S).length;if(!I&&!_||(a==null?void 0:a.filterMode)==="union"&&_!==h&&!I||(a==null?void 0:a.filterMode)==="intersection"&&(_!==h||!I))continue}u.push({index:g,matches:{...r,...S}})}return u}function ll(e,v,a,u){const w=N([]),m=N(new Map),h=k(()=>J(v));Se(()=>{const g=typeof a=="function"?a():J(a),F=typeof g!="string"&&typeof g!="number"?"":String(g),A=el(h.value,F,{customKeyFilter:{...e.customKeyFilter,...J(u==null?void 0:u.customKeyFilter)},default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),S=J(v),r=[],i=new Map;A.forEach(I=>{let{index:_,matches:L}=I;const M=S[_];r.push(M),i.set(M.value,L)}),w.value=r,m.value=i});function b(g){return m.value.get(g.value)}return{filteredItems:w,filteredMatches:m,getMatches:b}}function tl(e,v,a){if(v==null)return e;if(Array.isArray(v))throw new Error("Multiple matches is not implemented");return typeof v=="number"&&~v?c(X,null,[c("span",{class:"v-combobox__unmask"},[e.substr(0,v)]),c("span",{class:"v-combobox__mask"},[e.substr(v,a)]),c("span",{class:"v-combobox__unmask"},[e.substr(v+a)])]):e}const al=re({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...pe({filterKeys:["title"]}),...Me({hideNoData:!0,returnObject:!0}),...Pe(Ae({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...De({transition:!1})},"VCombobox"),ul=Ke()({name:"VCombobox",props:al(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,v){var ee;let{emit:a,slots:u}=v;const{t:w}=_e(),m=N(),h=B(!1),b=B(!0),g=B(!1),F=N(),A=N(),S=ae(e,"menu"),r=k({get:()=>S.value,set:l=>{var t;S.value&&!l&&((t=F.value)!=null&&t.Î¨openChildren.size)||(S.value=l)}}),i=B(-1);let I=!1;const _=k(()=>{var l;return(l=m.value)==null?void 0:l.color}),L=k(()=>r.value?e.closeText:e.openText),{items:M,transformIn:H,transformOut:j}=Ee(e),{textColorClasses:se,textColorStyles:ce}=Re(_),o=ae(e,"modelValue",[],l=>H(p(l)),l=>{const t=j(l);return e.multiple?t:t[0]??null}),O=Le(),$=k(()=>!!(e.chips||u.chip)),P=k(()=>$.value||!!u.selection),D=B(!e.multiple&&!P.value?((ee=o.value[0])==null?void 0:ee.title)??"":""),d=k({get:()=>D.value,set:l=>{var t;if(D.value=l??"",!e.multiple&&!P.value&&(o.value=[U(e,l)]),l&&e.multiple&&((t=e.delimiters)!=null&&t.length)){const f=l.split(new RegExp(`(?:${e.delimiters.join("|")})+`));f.length>1&&(f.forEach(n=>{n=n.trim(),n&&C(U(e,n))}),D.value="")}l||(i.value=-1),b.value=!l}}),ve=k(()=>typeof e.counterValue=="function"?e.counterValue(o.value):typeof e.counterValue=="number"?e.counterValue:e.multiple?o.value.length:d.value.length);z(D,l=>{I?ne(()=>I=!1):h.value&&!r.value&&(r.value=!0),a("update:search",l)}),z(o,l=>{var t;!e.multiple&&!P.value&&(D.value=((t=l[0])==null?void 0:t.title)??"")});const{filteredItems:Q,getMatches:fe}=ll(e,M,()=>b.value?"":d.value),K=k(()=>e.hideSelected?Q.value.filter(l=>!o.value.some(t=>t.value===l.value)):Q.value),de=k(()=>o.value.map(l=>l.value)),Y=k(()=>{var t;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&d.value===((t=K.value[0])==null?void 0:t.title))&&K.value.length>0&&!b.value&&!g.value}),Z=k(()=>e.hideNoData&&!K.value.length||e.readonly||(O==null?void 0:O.isReadonly.value)),q=N(),me=Oe(q,m);function he(l){I=!0,e.openOnClear&&(r.value=!0)}function ge(){Z.value||(r.value=!0)}function ye(l){Z.value||(h.value&&(l.preventDefault(),l.stopPropagation()),r.value=!r.value)}function be(l){var t;Xe(l)&&((t=m.value)==null||t.focus())}function xe(l){var n;if(Ye(l)||e.readonly||O!=null&&O.isReadonly.value)return;const t=m.value.selectionStart,f=o.value.length;if((i.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(r.value=!0),["Escape"].includes(l.key)&&(r.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(Y.value&&["Enter","Tab"].includes(l.key)&&!o.value.some(s=>{let{value:V}=s;return V===K.value[0].value})&&C(Q.value[0]),b.value=!0),l.key==="ArrowDown"&&Y.value&&((n=q.value)==null||n.focus("next")),l.key==="Enter"&&d.value&&(C(U(e,d.value)),P.value&&(D.value="")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&P.value&&o.value.length>0&&!d.value)return C(o.value[0],!1);if(~i.value){const s=i.value;C(o.value[i.value],!1),i.value=s>=f-1?f-2:s}else l.key==="Backspace"&&!d.value&&(i.value=f-1)}if(e.multiple){if(l.key==="ArrowLeft"){if(i.value<0&&t>0)return;const s=i.value>-1?i.value-1:f-1;o.value[s]?i.value=s:(i.value=-1,m.value.setSelectionRange(d.value.length,d.value.length))}if(l.key==="ArrowRight"){if(i.value<0)return;const s=i.value+1;o.value[s]?i.value=s:(i.value=-1,m.value.setSelectionRange(0,0))}}}function Ve(){var l;e.eager&&((l=A.value)==null||l.calculateVisibleItems())}function ke(){var l;h.value&&(b.value=!0,(l=m.value)==null||l.focus())}function C(l){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!l||l.props.disabled))if(e.multiple){const f=o.value.findIndex(s=>e.valueComparator(s.value,l.value)),n=t??!~f;if(~f){const s=n?[...o.value,l]:[...o.value];s.splice(f,1),o.value=s}else n&&(o.value=[...o.value,l]);e.clearOnSelect&&(d.value="")}else{const f=t!==!1;o.value=f?[l]:[],D.value=f&&!P.value?l.title:"",ne(()=>{r.value=!1,b.value=!0})}}function Fe(l){h.value=!0,setTimeout(()=>{g.value=!0})}function Ce(l){g.value=!1}function we(l){(l==null||l===""&&!e.multiple&&!P.value)&&(o.value=[])}return z(h,(l,t)=>{if(!(l||l===t)&&(i.value=-1,r.value=!1,d.value)){if(e.multiple){C(U(e,d.value));return}if(!P.value)return;o.value.some(f=>{let{title:n}=f;return n===d.value})?D.value="":C(U(e,d.value))}}),z(r,()=>{if(!e.hideSelected&&r.value&&o.value.length){const l=K.value.findIndex(t=>o.value.some(f=>e.valueComparator(f.value,t.value)));Ze&&window.requestAnimationFrame(()=>{var t;l>=0&&((t=A.value)==null||t.scrollToIndex(l))})}}),z(()=>e.items,(l,t)=>{r.value||h.value&&!t.length&&l.length&&(r.value=!0)}),Te(()=>{const l=!!(!e.hideNoData||K.value.length||u["prepend-item"]||u["append-item"]||u["no-data"]),t=o.value.length>0,f=ue.filterProps(e);return c(ue,T({ref:m},f,{modelValue:d.value,"onUpdate:modelValue":[n=>d.value=n,we],focused:h.value,"onUpdate:focused":n=>h.value=n,validationValue:o.externalValue,counterValue:ve.value,dirty:t,class:["v-combobox",{"v-combobox--active-menu":r.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!P.value,"v-combobox--selecting-index":i.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:e.readonly,placeholder:t?void 0:e.placeholder,"onClick:clear":he,"onMousedown:control":ge,onKeydown:xe}),{...u,default:()=>c(X,null,[c(Ne,T({ref:F,modelValue:r.value,"onUpdate:modelValue":n=>r.value=n,activator:"parent",contentClass:"v-combobox__content",disabled:Z.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:Ve,onAfterLeave:ke},e.menuProps),{default:()=>[l&&c(je,T({ref:q,selected:de.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:n=>n.preventDefault(),onKeydown:be,onFocusin:Fe,onFocusout:Ce,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},me,e.listProps),{default:()=>{var n,s,V;return[(n=u["prepend-item"])==null?void 0:n.call(u),!K.value.length&&!e.hideNoData&&(((s=u["no-data"])==null?void 0:s.call(u))??c(ie,{title:w(e.noDataText)},null)),c(Be,{ref:A,renderless:!0,items:K.value},{default:E=>{var te;let{item:y,index:R,itemRef:x}=E;const le=T(y.props,{ref:x,key:R,active:Y.value&&R===0?!0:void 0,onClick:()=>C(y,null)});return((te=u.item)==null?void 0:te.call(u,{item:y,index:R,props:le}))??c(ie,T(le,{role:"option"}),{prepend:W=>{let{isSelected:G}=W;return c(X,null,[e.multiple&&!e.hideSelected?c(Ue,{key:y.value,modelValue:G,ripple:!1,tabindex:"-1"},null):void 0,y.props.prependAvatar&&c(ze,{image:y.props.prependAvatar},null),y.props.prependIcon&&c(oe,{icon:y.props.prependIcon},null)])},title:()=>{var W,G;return b.value?y.title:tl(y.title,(W=fe(y))==null?void 0:W.title,((G=d.value)==null?void 0:G.length)??0)}})}}),(V=u["append-item"])==null?void 0:V.call(u)]}})]}),o.value.map((n,s)=>{function V(x){x.stopPropagation(),x.preventDefault(),C(n,!1)}const E={"onClick:close":V,onKeydown(x){x.key!=="Enter"&&x.key!==" "||(x.preventDefault(),x.stopPropagation(),V(x))},onMousedown(x){x.preventDefault(),x.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},y=$.value?!!u.chip:!!u.selection,R=y?He($.value?u.chip({item:n,index:s,props:E}):u.selection({item:n,index:s})):void 0;if(!(y&&!R))return c("div",{key:n.value,class:["v-combobox__selection",s===i.value&&["v-combobox__selection--selected",se.value]],style:s===i.value?ce.value:{}},[$.value?u.chip?c(Qe,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:n.title}}},{default:()=>[R]}):c($e,T({key:"chip",closable:e.closableChips,size:"small",text:n.title,disabled:n.props.disabled},E),null):R??c("span",{class:"v-combobox__selection-text"},[n.title,e.multiple&&s<o.value.length-1&&c("span",{class:"v-combobox__selection-comma"},[We(",")])])])})]),"append-inner":function(){var E;for(var n=arguments.length,s=new Array(n),V=0;V<n;V++)s[V]=arguments[V];return c(X,null,[(E=u["append-inner"])==null?void 0:E.call(u,...s),(!e.hideNoData||e.items.length)&&e.menuIcon?c(oe,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:ye,onClick:Ge,"aria-label":w(L.value),title:w(L.value),tabindex:"-1"},null):void 0])}})}),Je({isFocused:h,isPristine:b,menu:r,search:d,selectionIndex:i,filteredItems:Q,select:C},m)}});export{ul as V};
